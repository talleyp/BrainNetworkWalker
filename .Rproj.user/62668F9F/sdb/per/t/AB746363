{
    "collab_server" : "",
    "contents" : "# TO DO: Correlation of matrices with FC\n\nlibrary(igraph)\n\npath.row = paste(path.image, \"rowMatrices\", sep=\"/\")\npath.col = paste(path.image, \"colMatrices\", sep=\"/\")\npath.mix = paste(path.image, \"mixMatrices\", sep=\"/\")\n\nmfpt100 = mfpt_SCden[100,,]\nMixMaxCor = matrix(data=0, nrow=139, ncol=139)\nfor(i in 1:138){\n    rowi = mfpt100[i,]\n    for(j in (i+1):139){\n        rowj = mfpt100[j,]\n        corij = cor(rowi, rowj, use = \"pairwise.complete.obs\")\n        MixMaxCor[i,j] = corij\n    }\n}\n\n# Column pairwise correlation\nfor(i in 1:138){\n    coli = mfpt100[,i]\n    for(j in (i+1):139){\n        colj = mfpt100[,j]\n        corij = cor(coli, colj, use = \"pairwise.complete.obs\")\n        MixMaxCor[j,i] = corij\n    }\n}\n\nsymMix <- (MixMaxCor[ , ] + t(MixMaxCor[,])) / 2\ndiag(symMix[,]) <- 0\n# sympos = sym\n# for(i in 1:139){\n#     for(j in 1:139){\n#         if(sympos[i,j]<0){\n#             sympos[i,j] = 0\n#         }\n#     }\n# }\ngMixed = graph_from_adjacency_matrix(sym, mode = \"undirected\", weighted = TRUE)\nclMixed = spinglass.community(gMixed)\nMixCl = NULL\nfor(i in 1:length(cl$csize)){\n    MixCl = c(MixCl, cl[i])\n}\nMixCl = unlist(MixCl, use.names = F)\n\nheatPlot(sym[MixCl,MixCl], \"spinglass\",\"spinglass.png\")\n\ncor_mix <- rep(NULL, numSteps)\ncor_row<- rep(NULL, numSteps)\ncor_col <- rep(NULL, numSteps)\n\nfor(step in 1:100){\n    MixCor = matrix(data=0, nrow=139, ncol=139)\n    RowCor = matrix(data=0, nrow=139, ncol=139)\n    ColCor = matrix(data=0, nrow=139, ncol=139)\n    \n    #row pairwise correlation\n    for(i in 1:138){\n        rowi = mfpt_SCden[step, i,]\n        for(j in (i+1):139){\n            rowj = mfpt_SCden[step, j,]\n            corij = cor(rowi, rowj, use = \"pairwise.complete.obs\")\n            RowCor[i,j] = corij\n            RowCor[j,i] = corij\n            MixCor[i,j] = corij\n        }\n    }\n    \n    # Column pairwise correlation\n    for(i in 1:138){\n        coli =  mfpt_SCden[step, , i]\n        for(j in (i+1):139){\n            colj = mfpt_SCden[step, , j]\n            corij = cor(coli, colj, use = \"pairwise.complete.obs\")\n            ColCor[i,j] = corij\n            ColCor[j,i] = corij\n            MixCor[j,i] = corij\n        }\n    }\n    symMix <- (MixCor[ , ] + t(MixCor[,])) / 2\n    diag(symMix[,]) <- 0\n    titleRow = paste(step, \"row\")\n    fileRow = paste(path.row, paste(step,\"_row.png\",sep=\"\"), sep=\"/\")\n    titleCol = paste(step, \"col\")\n    fileCol = paste(path.col, paste(step,\"_col.png\",sep=\"\"), sep=\"/\")\n    titleMix = paste(step, \"mix\")\n    fileMix = paste(path.mix, paste(step,\"_mix.png\",sep=\"\"), sep=\"/\")\n    \n    cor_mix[step] <- cor(c(FC), c(symMix),use = \"pairwise.complete.obs\")\n    cor_row[step] <- cor(c(FC), c(RowCor),use = \"pairwise.complete.obs\")\n    cor_col[step] <- cor(c(FC), c(ColCor),use = \"pairwise.complete.obs\")\n    \n    heatPlot(RowCor[MixCl,MixCl], titleRow, fileRow)\n    heatPlot(ColCor[MixCl,MixCl], titleCol, fileCol)\n    heatPlot(symMix[MixCl,MixCl], titleMix,fileMix)\n}\n\nstepVec <- seq(1, numSteps)\ncor_matrix = as.data.frame(cbind(stepVec, cor_mix, cor_col, cor_row))\nggplot(data = cor_matrix, aes(x= stepVec, y = value, color = variable)) + \n    geom_point(aes(y = cor_mix, col = \"cor_mix\")) + \n    geom_line(aes(y = cor_mix, col = \"cor_mix\")) + \n    geom_point(aes(y = cor_col, col = \"cor_col\")) +  \n    geom_line(aes(y = cor_col, col = \"cor_col\")) + \n    geom_point(aes(y = cor_row, col = \"cor_row\")) + \n    geom_line(aes(y = cor_row, col = \"cor_row\")) + \n    labs(x=\"Step\", y=\"Correlation\")\nggsave(paste(getwd(),\"/limited_time_mfpt\",\"/results\",\"/pairwise_cor.png\", sep = '/'))\n",
    "created" : 1461845719957.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "27596904",
    "id" : "AB746363",
    "lastKnownWriteTime" : 1462271761,
    "last_content_update" : 1462271761042,
    "path" : "/run/media/renge/Beta/Documents/Research/limited_time_mfpt/code/pairwise_cor.R",
    "project_path" : "limited_time_mfpt/code/pairwise_cor.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}